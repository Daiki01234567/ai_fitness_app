# ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰

**å¯¾è±¡**: ä¸­å­¦ç”Ÿã€œé«˜æ ¡ç”Ÿãƒ»åˆå¿ƒè€…ãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ¼
**æœ€çµ‚æ›´æ–°**: 2025å¹´12æœˆ10æ—¥

---

## ã“ã®ã‚¬ã‚¤ãƒ‰ã«ã¤ã„ã¦

ã“ã®ã‚¬ã‚¤ãƒ‰ã§ã¯ã€é–‹ç™ºä¸­ã«ã‚ˆãé­é‡ã™ã‚‹ã‚¨ãƒ©ãƒ¼ã‚„å•é¡Œã®è§£æ±ºæ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚

**ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°** ã¨ã¯ã€å•é¡ŒãŒç™ºç”Ÿã—ãŸã¨ãã«åŸå› ã‚’ç‰¹å®šã—ã¦è§£æ±ºã™ã‚‹ã“ã¨ã§ã™ã€‚

---

## ç›®æ¬¡

1. [ç’°å¢ƒæ§‹ç¯‰ã®ãƒˆãƒ©ãƒ–ãƒ«](#ç’°å¢ƒæ§‹ç¯‰ã®ãƒˆãƒ©ãƒ–ãƒ«)
2. [Firebase ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã®ãƒˆãƒ©ãƒ–ãƒ«](#firebase-ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã®ãƒˆãƒ©ãƒ–ãƒ«)
3. [Cloud Functions ã®ãƒˆãƒ©ãƒ–ãƒ«](#cloud-functions-ã®ãƒˆãƒ©ãƒ–ãƒ«)
4. [Firestore ã®ãƒˆãƒ©ãƒ–ãƒ«](#firestore-ã®ãƒˆãƒ©ãƒ–ãƒ«)
5. [ãƒ†ã‚¹ãƒˆã®ãƒˆãƒ©ãƒ–ãƒ«](#ãƒ†ã‚¹ãƒˆã®ãƒˆãƒ©ãƒ–ãƒ«)
6. [ãƒ‡ãƒ—ãƒ­ã‚¤ã®ãƒˆãƒ©ãƒ–ãƒ«](#ãƒ‡ãƒ—ãƒ­ã‚¤ã®ãƒˆãƒ©ãƒ–ãƒ«)
7. [Git ã®ãƒˆãƒ©ãƒ–ãƒ«](#git-ã®ãƒˆãƒ©ãƒ–ãƒ«)

---

## ç’°å¢ƒæ§‹ç¯‰ã®ãƒˆãƒ©ãƒ–ãƒ«

### ã‚¨ãƒ©ãƒ¼: `command not found: firebase`

**ç—‡çŠ¶**:
```bash
$ firebase --version
command not found: firebase
```

**åŸå› **: Firebase CLI ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„ã€ã¾ãŸã¯PATHãŒé€šã£ã¦ã„ãªã„

**è§£æ±ºæ³•**:

1. **ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª**
```bash
npm list -g firebase-tools
```

2. **ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„å ´åˆ**
```bash
npm install -g firebase-tools
```

3. **PATHã®å•é¡Œã®å ´åˆ**ï¼ˆMac/Linuxï¼‰
```bash
# .bashrc ã¾ãŸã¯ .zshrc ã«è¿½åŠ 
export PATH="$PATH:$(npm config get prefix)/bin"

# è¨­å®šã‚’å†èª­ã¿è¾¼ã¿
source ~/.bashrc  # ã¾ãŸã¯ source ~/.zshrc
```

---

### ã‚¨ãƒ©ãƒ¼: `npm ERR! code EACCES`

**ç—‡çŠ¶**:
```bash
$ npm install -g firebase-tools
npm ERR! code EACCES
npm ERR! syscall access
npm ERR! path /usr/local/lib/node_modules
npm ERR! errno -13
```

**åŸå› **: æ¨©é™ãŒãªã„

**è§£æ±ºæ³•**:

**Mac/Linux**:
```bash
sudo npm install -g firebase-tools
```

**Windows**:
1. PowerShell ã‚’ã€Œç®¡ç†è€…ã¨ã—ã¦å®Ÿè¡Œã€
2. `npm install -g firebase-tools` ã‚’å®Ÿè¡Œ

---

### ã‚¨ãƒ©ãƒ¼: `node: No such file or directory`

**åŸå› **: Node.js ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„

**è§£æ±ºæ³•**:

1. **Node.js ã®å…¬å¼ã‚µã‚¤ãƒˆã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**
   - https://nodejs.org/
   - LTSç‰ˆã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

2. **ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèª**
```bash
node --version
npm --version
```

---

## Firebase ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã®ãƒˆãƒ©ãƒ–ãƒ«

### ã‚¨ãƒ©ãƒ¼: `Port 8080 is already in use`

**ç—‡çŠ¶**:
```bash
$ firebase emulators:start
âš   firestore: Port 8080 is already in use.
```

**åŸå› **: ãƒãƒ¼ãƒˆ8080ãŒåˆ¥ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«ä½¿ã‚ã‚Œã¦ã„ã‚‹

**è§£æ±ºæ³•**:

**æ–¹æ³•1: ä½¿ç”¨ä¸­ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’çµ‚äº†**

**Windows**:
```bash
# ãƒãƒ¼ãƒˆ8080ã‚’ä½¿ã£ã¦ã„ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ¢ã™
netstat -ano | findstr :8080

# è¡¨ç¤ºã•ã‚ŒãŸPIDï¼ˆãƒ—ãƒ­ã‚»ã‚¹IDï¼‰ã‚’ä½¿ã£ã¦ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’çµ‚äº†
taskkill /PID <ãƒ—ãƒ­ã‚»ã‚¹ID> /F
```

**Mac/Linux**:
```bash
# ãƒãƒ¼ãƒˆ8080ã‚’ä½¿ã£ã¦ã„ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ¢ã™
lsof -i :8080

# è¡¨ç¤ºã•ã‚ŒãŸPIDã‚’ä½¿ã£ã¦ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’çµ‚äº†
kill -9 <PID>
```

**æ–¹æ³•2: åˆ¥ã®ãƒãƒ¼ãƒˆã‚’ä½¿ã†**

`firebase.json` ã‚’ç·¨é›†:
```json
{
  "emulators": {
    "firestore": {
      "port": 8081  // åˆ¥ã®ãƒãƒ¼ãƒˆã«å¤‰æ›´
    }
  }
}
```

---

### ã‚¨ãƒ©ãƒ¼: `Firestore Emulator has exited because java is not installed`

**åŸå› **: Java ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„

**è§£æ±ºæ³•**:

1. **Java ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**
```bash
# Mac (Homebrew)
brew install openjdk@11

# Windows
# https://www.oracle.com/java/technologies/downloads/
# ã‹ã‚‰ Java 11 ä»¥ä¸Šã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
```

2. **ç¢ºèª**
```bash
java -version
```

---

### ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãŒèµ·å‹•ã—ãªã„

**ç—‡çŠ¶**:
```bash
$ firebase emulators:start
âš   emulators: Failed to start emulators
```

**ç¢ºèªé …ç›®**:

1. **firebase.json ãŒæ­£ã—ã„ã‹ç¢ºèª**
```bash
cat firebase.json
```

2. **ãƒãƒ¼ãƒˆãŒç©ºã„ã¦ã„ã‚‹ã‹ç¢ºèª**
```bash
# å…¨ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã®ãƒãƒ¼ãƒˆã‚’ç¢ºèª
netstat -ano | findstr :4000  # UI
netstat -ano | findstr :8080  # Firestore
netstat -ano | findstr :9099  # Auth
netstat -ano | findstr :5001  # Functions
```

3. **ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª**
```bash
cat firebase-debug.log
```

---

## Cloud Functions ã®ãƒˆãƒ©ãƒ–ãƒ«

### ã‚¨ãƒ©ãƒ¼: `TypeError: Cannot read property 'xxx' of undefined`

**ç—‡çŠ¶**:
```typescript
TypeError: Cannot read property 'displayName' of undefined
```

**åŸå› **: ãƒ‡ãƒ¼ã‚¿ãŒå­˜åœ¨ã—ãªã„ã®ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã‚ˆã†ã¨ã—ã¦ã„ã‚‹

**è§£æ±ºæ³•**:

```typescript
// âŒ æ‚ªã„ä¾‹
const name = user.displayName;  // user ãŒ undefined ã ã¨ã‚¨ãƒ©ãƒ¼

// âœ… è‰¯ã„ä¾‹1: Optional Chaining
const name = user?.displayName;  // undefined ã®å ´åˆã¯ undefined ã‚’è¿”ã™

// âœ… è‰¯ã„ä¾‹2: ãƒã‚§ãƒƒã‚¯
if (user && user.displayName) {
  const name = user.displayName;
}

// âœ… è‰¯ã„ä¾‹3: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤
const name = user?.displayName ?? "åç„¡ã—";
```

---

### ã‚¨ãƒ©ãƒ¼: `DEADLINE_EXCEEDED`

**ç—‡çŠ¶**:
```
Error: DEADLINE_EXCEEDED: Deadline exceeded
```

**åŸå› **: å‡¦ç†ãŒã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼ˆæ™‚é–“åˆ‡ã‚Œï¼‰ã—ãŸ

**è§£æ±ºæ³•**:

**æ–¹æ³•1: ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆæ™‚é–“ã‚’å»¶é•·**
```typescript
import * as functions from "firebase-functions/v2";

export const myFunction = functions.runWith({
  timeoutSeconds: 300,  // 5åˆ†ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯60ç§’ï¼‰
}).onCall(async (request) => {
  // å‡¦ç†
});
```

**æ–¹æ³•2: å‡¦ç†ã‚’æœ€é©åŒ–**
```typescript
// âŒ æ‚ªã„ä¾‹: é †æ¬¡å‡¦ç†ï¼ˆé…ã„ï¼‰
const user = await getUser(userId);
const sessions = await getSessions(userId);
const consents = await getConsents(userId);

// âœ… è‰¯ã„ä¾‹: ä¸¦åˆ—å‡¦ç†ï¼ˆé€Ÿã„ï¼‰
const [user, sessions, consents] = await Promise.all([
  getUser(userId),
  getSessions(userId),
  getConsents(userId),
]);
```

---

### ã‚¨ãƒ©ãƒ¼: `UNAUTHENTICATED`

**ç—‡çŠ¶**:
```
Error: UNAUTHENTICATED: The request does not have valid authentication credentials
```

**åŸå› **: èªè¨¼ã•ã‚Œã¦ã„ãªã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒAPIã‚’å‘¼ã³å‡ºã—ãŸ

**ç¢ºèªé …ç›®**:

1. **ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã‚‹ã‹**
```dart
// Flutter
final user = FirebaseAuth.instance.currentUser;
if (user == null) {
  print("ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã¾ã›ã‚“");
}
```

2. **ãƒˆãƒ¼ã‚¯ãƒ³ãŒæœŸé™åˆ‡ã‚Œã§ãªã„ã‹**
```dart
// Flutter: ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å†å–å¾—
await FirebaseAuth.instance.currentUser?.getIdToken(true);
```

3. **ã‚µãƒ¼ãƒãƒ¼å´ã§èªè¨¼ãƒã‚§ãƒƒã‚¯ã—ã¦ã„ã‚‹ã‹**
```typescript
// Cloud Functions
if (!request.auth) {
  throw new functions.https.HttpsError(
    "unauthenticated",
    "èªè¨¼ãŒå¿…è¦ã§ã™"
  );
}
```

---

### ã‚¨ãƒ©ãƒ¼: `PERMISSION_DENIED`

**ç—‡çŠ¶**:
```
Error: PERMISSION_DENIED: Missing or insufficient permissions
```

**åŸå› **: ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ãŒãªã„

**ç¢ºèªé …ç›®**:

1. **Firestore Rules ã‚’ç¢ºèª**
```bash
cat firebase/firestore.rules
```

2. **è‡ªåˆ†ã®ãƒ‡ãƒ¼ã‚¿ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã„ã‚‹ã‹ç¢ºèª**
```typescript
// Cloud Functions
const userId = request.auth.uid;
const requestedUserId = request.data.userId;

if (userId !== requestedUserId) {
  throw new functions.https.HttpsError(
    "permission-denied",
    "ä»–äººã®ãƒ‡ãƒ¼ã‚¿ã«ã¯ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã›ã‚“"
  );
}
```

---

### ã‚¨ãƒ©ãƒ¼: `Module not found`

**ç—‡çŠ¶**:
```
Error: Cannot find module './api/users/updateProfile'
```

**åŸå› **: ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ‘ã‚¹ãŒé–“é•ã£ã¦ã„ã‚‹

**è§£æ±ºæ³•**:

1. **ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã™ã‚‹ã‹ç¢ºèª**
```bash
ls functions/src/api/users/updateProfile.ts
```

2. **ãƒ‘ã‚¹ã‚’ä¿®æ­£**
```typescript
// âŒ é–“é•ã„
import { updateProfile } from "./api/users/updateProfile";

// âœ… æ­£ã—ã„ï¼ˆç›¸å¯¾ãƒ‘ã‚¹ï¼‰
import { updateProfile } from "../../api/users/updateProfile";
```

---

## Firestore ã®ãƒˆãƒ©ãƒ–ãƒ«

### ã‚¨ãƒ©ãƒ¼: `7 PERMISSION_DENIED: Missing or insufficient permissions`

**ç—‡çŠ¶**:
Firestore ã«ãƒ‡ãƒ¼ã‚¿ã‚’æ›¸ãè¾¼ã‚‚ã†ã¨ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼

**åŸå› **: Firestore Security Rules ã§ã‚¢ã‚¯ã‚»ã‚¹ãŒæ‹’å¦ã•ã‚Œã¦ã„ã‚‹

**ç¢ºèªæ–¹æ³•**:

1. **ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã§ç¢ºèª**
```bash
firebase emulators:start
```
http://localhost:4000 â†’ Firestore â†’ ãƒ«ãƒ¼ãƒ«

2. **ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ**
```bash
cd firebase
npm test
```

**è§£æ±ºæ³•**:

**é–‹ç™ºä¸­ã®ä¸€æ™‚çš„ãªå¯¾ç­–**ï¼ˆæœ¬ç•ªã§ã¯ä½¿ç”¨ç¦æ­¢ï¼‰:
```javascript
// firebase/firestore.rules
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // âš ï¸ é–‹ç™ºç”¨ã®ã¿ï¼æœ¬ç•ªã§ã¯çµ¶å¯¾ã«ä½¿ã‚ãªã„
    match /{document=**} {
      allow read, write: if true;
    }
  }
}
```

**æœ¬ç•ªç”¨ã®æ­£ã—ã„ãƒ«ãƒ¼ãƒ«**:
```javascript
match /users/{userId} {
  allow read, write: if request.auth != null && request.auth.uid == userId;
}
```

---

### ãƒ‡ãƒ¼ã‚¿ãŒä¿å­˜ã•ã‚Œãªã„

**ç—‡çŠ¶**:
Firestoreã«ãƒ‡ãƒ¼ã‚¿ã‚’æ›¸ãè¾¼ã‚“ã§ã‚‚åæ˜ ã•ã‚Œãªã„

**ç¢ºèªé …ç›®**:

1. **await ã‚’ä½¿ã£ã¦ã„ã‚‹ã‹**
```typescript
// âŒ æ‚ªã„ä¾‹: awaitãŒãªã„
firestore.collection("users").doc(userId).set(data);
// â†’ å‡¦ç†ãŒå®Œäº†ã™ã‚‹å‰ã«é–¢æ•°ãŒçµ‚äº†ã™ã‚‹

// âœ… è‰¯ã„ä¾‹
await firestore.collection("users").doc(userId).set(data);
```

2. **ã‚¨ãƒ©ãƒ¼ã‚’ã‚­ãƒ£ãƒƒãƒã—ã¦ã„ã‚‹ã‹**
```typescript
try {
  await firestore.collection("users").doc(userId).set(data);
} catch (error) {
  console.error("ä¿å­˜ã‚¨ãƒ©ãƒ¼:", error);
  // â† ã“ã“ã§ã‚¨ãƒ©ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹
}
```

3. **Firebase Console ã§ç¢ºèª**
https://console.firebase.google.com/ â†’ Firestore â†’ ãƒ‡ãƒ¼ã‚¿

---

## ãƒ†ã‚¹ãƒˆã®ãƒˆãƒ©ãƒ–ãƒ«

### ã‚¨ãƒ©ãƒ¼: `ECONNREFUSED localhost:8080`

**ç—‡çŠ¶**:
```bash
$ npm test
Error: connect ECONNREFUSED 127.0.0.1:8080
```

**åŸå› **: Firestore ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãŒèµ·å‹•ã—ã¦ã„ãªã„

**è§£æ±ºæ³•**:

åˆ¥ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã‚’èµ·å‹•:
```bash
firebase emulators:start --only firestore
```

ãã®å¾Œã€ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ:
```bash
npm test
```

---

### ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã™ã‚‹

**ç—‡çŠ¶**:
```bash
$ npm test
FAIL  tests/api/users/updateProfile.test.ts
  âœ• ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ›´æ–°ãŒæˆåŠŸã™ã‚‹ (52ms)

  Expected: 200
  Received: 401
```

**ãƒ‡ãƒãƒƒã‚°æ–¹æ³•**:

1. **ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’èª­ã‚€**
   - Expectedï¼ˆæœŸå¾…å€¤ï¼‰ã¨ Receivedï¼ˆå®Ÿéš›ã®å€¤ï¼‰ã‚’ç¢ºèª

2. **ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèª**
```typescript
test("ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ›´æ–°ãŒæˆåŠŸã™ã‚‹", async () => {
  // ã“ã“ã« console.log ã‚’è¿½åŠ ã—ã¦ãƒ‡ãƒãƒƒã‚°
  console.log("userId:", userId);
  console.log("data:", data);

  const result = await updateProfile(userId, data);
  console.log("result:", result);

  expect(result.status).toBe(200);
});
```

3. **å®Ÿè£…ã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèª**
   - ãƒ†ã‚¹ãƒˆãŒæœŸå¾…ã—ã¦ã„ã‚‹å‹•ä½œã¨å®Ÿè£…ãŒä¸€è‡´ã—ã¦ã„ã‚‹ã‹

---

### ãƒ†ã‚¹ãƒˆãŒã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã™ã‚‹

**ç—‡çŠ¶**:
```
Timeout - Async callback was not invoked within the 5000 ms timeout
```

**åŸå› **: éåŒæœŸå‡¦ç†ãŒå®Œäº†ã—ãªã„

**è§£æ±ºæ³•**:

**æ–¹æ³•1: ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆæ™‚é–“ã‚’å»¶é•·**
```typescript
test("é‡ã„å‡¦ç†", async () => {
  // ãƒ†ã‚¹ãƒˆå†…å®¹
}, 30000);  // 30ç§’ã«å»¶é•·ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯5ç§’ï¼‰
```

**æ–¹æ³•2: await ã‚’ç¢ºèª**
```typescript
// âŒ æ‚ªã„ä¾‹: await ãŒãªã„
test("ãƒ†ã‚¹ãƒˆ", async () => {
  someAsyncFunction();  // â† await ãŒãªã„ã¨ãƒ†ã‚¹ãƒˆãŒçµ‚ã‚ã‚‰ãªã„
});

// âœ… è‰¯ã„ä¾‹
test("ãƒ†ã‚¹ãƒˆ", async () => {
  await someAsyncFunction();
});
```

---

## ãƒ‡ãƒ—ãƒ­ã‚¤ã®ãƒˆãƒ©ãƒ–ãƒ«

### ã‚¨ãƒ©ãƒ¼: `HTTP Error: 403, The caller does not have permission`

**åŸå› **: ãƒ‡ãƒ—ãƒ­ã‚¤æ¨©é™ãŒãªã„

**è§£æ±ºæ³•**:

1. **Firebase Console ã§æ¨©é™ã‚’ç¢ºèª**
   - https://console.firebase.google.com/
   - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®š â†’ ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨æ¨©é™
   - è‡ªåˆ†ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒã€Œç·¨é›†è€…ã€ä»¥ä¸Šã‹ç¢ºèª

2. **å†ãƒ­ã‚°ã‚¤ãƒ³**
```bash
firebase logout
firebase login
```

---

### ã‚¨ãƒ©ãƒ¼: `Build failed`

**ç—‡çŠ¶**:
```
Functions deploy had errors with the following functions:
  updateProfile(asia-northeast1)
```

**åŸå› **: TypeScript ã®ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼

**è§£æ±ºæ³•**:

1. **ãƒ­ãƒ¼ã‚«ãƒ«ã§ãƒ“ãƒ«ãƒ‰**
```bash
cd functions
npm run build
```

2. **ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèª**
```
error TS2304: Cannot find name 'xxx'.
```

3. **ã‚¨ãƒ©ãƒ¼ã‚’ä¿®æ­£ã—ã¦ã‹ã‚‰å†ãƒ‡ãƒ—ãƒ­ã‚¤**

---

## Git ã®ãƒˆãƒ©ãƒ–ãƒ«

### ã‚¨ãƒ©ãƒ¼: `fatal: not a git repository`

**ç—‡çŠ¶**:
```bash
$ git status
fatal: not a git repository (or any of the parent directories): .git
```

**åŸå› **: Gitãƒªãƒã‚¸ãƒˆãƒªãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ãªã„

**è§£æ±ºæ³•**:
```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã§å®Ÿè¡Œ
git init
```

---

### ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆï¼ˆç«¶åˆï¼‰ãŒç™ºç”Ÿã—ãŸ

**ç—‡çŠ¶**:
```bash
$ git pull
Auto-merging file.ts
CONFLICT (content): Merge conflict in file.ts
Automatic merge failed; fix conflicts and then commit the result.
```

**è§£æ±ºæ³•**:

1. **ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆã—ã¦ã„ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã**

ãƒ•ã‚¡ã‚¤ãƒ«å†…ã«ä»¥ä¸‹ã®ã‚ˆã†ãªãƒãƒ¼ã‚¯ãŒè¡¨ç¤ºã•ã‚Œã¾ã™:
```typescript
<<<<<<< HEAD
// è‡ªåˆ†ã®å¤‰æ›´
const value = 1;
=======
// ä»–ã®äººã®å¤‰æ›´
const value = 2;
>>>>>>> branch-name
```

2. **æ­£ã—ã„ã‚³ãƒ¼ãƒ‰ã‚’æ®‹ã™**
```typescript
// ã©ã¡ã‚‰ã‹ã‚’é¸ã¶ã€ã¾ãŸã¯ä¸¡æ–¹ã‚’çµ±åˆ
const value = 1;  // æœ€çµ‚çš„ãªã‚³ãƒ¼ãƒ‰
```

3. **ãƒãƒ¼ã‚¯ã‚’å‰Šé™¤**
```typescript
// <<<<<<< HEAD ãªã©ã®ãƒãƒ¼ã‚¯ã‚’å…¨ã¦å‰Šé™¤
```

4. **ã‚³ãƒŸãƒƒãƒˆ**
```bash
git add file.ts
git commit -m "fix: ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆã‚’è§£æ±º"
```

---

### é–“é•ã£ã¦ã‚³ãƒŸãƒƒãƒˆã—ã¦ã—ã¾ã£ãŸ

**ç—‡çŠ¶**:
é–“é•ã£ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒŸãƒƒãƒˆã—ã¦ã—ã¾ã£ãŸ

**è§£æ±ºæ³•**:

**æ–¹æ³•1: ç›´å‰ã®ã‚³ãƒŸãƒƒãƒˆã‚’å–ã‚Šæ¶ˆã—**
```bash
# ã‚³ãƒŸãƒƒãƒˆã‚’å–ã‚Šæ¶ˆã—ï¼ˆå¤‰æ›´ã¯æ®‹ã‚‹ï¼‰
git reset --soft HEAD~1

# ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿®æ­£ã—ã¦ã‹ã‚‰å†ã‚³ãƒŸãƒƒãƒˆ
git add <æ­£ã—ã„ãƒ•ã‚¡ã‚¤ãƒ«>
git commit -m "æ­£ã—ã„ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"
```

**æ–¹æ³•2: ã‚³ãƒŸãƒƒãƒˆã‚’æ‰“ã¡æ¶ˆã™ï¼ˆæ¨å¥¨ï¼‰**
```bash
# æ–°ã—ã„ã‚³ãƒŸãƒƒãƒˆã§æ‰“ã¡æ¶ˆã—
git revert HEAD
```

---

## ã‚ˆãã‚ã‚‹å•é¡Œã¨å¯¾å‡¦æ³•

### ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒåˆã‚ãªã„

**ç—‡çŠ¶**:
```
npm WARN deprecated xxx@1.0.0
```

**è§£æ±ºæ³•**:
```bash
# ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’æœ€æ–°ã«æ›´æ–°
cd functions
npm update

# ã¾ãŸã¯
rm -rf node_modules package-lock.json
npm install
```

---

### ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãŒé…ã„

**å¯¾ç­–**:

1. **ä¸è¦ãªã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã‚’ç„¡åŠ¹åŒ–**
```bash
# Firestoreã ã‘èµ·å‹•
firebase emulators:start --only firestore
```

2. **å¤ã„ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤**
```bash
# ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªã‚¢
firebase emulators:start --import=./emulator-data --export-on-exit
```

---

### ãƒ¡ãƒ¢ãƒªä¸è¶³ã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶**:
```
JavaScript heap out of memory
```

**è§£æ±ºæ³•**:

**Node.js ã®ãƒ¡ãƒ¢ãƒªã‚’å¢—ã‚„ã™**:
```bash
# ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®š
export NODE_OPTIONS="--max-old-space-size=4096"

# ã¾ãŸã¯ package.json ã«è¿½åŠ 
"scripts": {
  "build": "NODE_OPTIONS='--max-old-space-size=4096' tsc"
}
```

---

## å•é¡ŒãŒè§£æ±ºã—ãªã„ã¨ã

### ã‚¹ãƒ†ãƒƒãƒ—1: ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’èª­ã‚€

- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ã¯è§£æ±ºã®ãƒ’ãƒ³ãƒˆãŒæ›¸ã„ã¦ã‚ã‚‹ã“ã¨ãŒå¤šã„
- Googleç¿»è¨³ãªã©ã‚’ä½¿ã£ã¦æ—¥æœ¬èªã«ã—ã¦ã¿ã‚‹

### ã‚¹ãƒ†ãƒƒãƒ—2: ãƒ­ã‚°ã‚’ç¢ºèª

```bash
# Firebase Functions ã®ãƒ­ã‚°
firebase functions:log

# ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã®ãƒ­ã‚°
cat firebase-debug.log

# npm ã®ãƒ­ã‚°
cat npm-debug.log
```

### ã‚¹ãƒ†ãƒƒãƒ—3: æ¤œç´¢ã™ã‚‹

Google ã§ä»¥ä¸‹ã®ã‚ˆã†ã«æ¤œç´¢:
```
"ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸" firebase functions
```

ä¾‹:
```
"DEADLINE_EXCEEDED" firebase functions
```

### ã‚¹ãƒ†ãƒƒãƒ—4: å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ç¢ºèª

- [Firebase ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://firebase.google.com/docs)
- [Stack Overflow](https://stackoverflow.com/)ï¼ˆè‹±èªï¼‰

### ã‚¹ãƒ†ãƒƒãƒ—5: ãƒãƒ¼ãƒ ã«èã

- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦å…±æœ‰
- ä½•ã‚’ã—ã‚ˆã†ã¨ã—ãŸã‹èª¬æ˜
- ã©ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¤‰æ›´ã—ãŸã‹å…±æœ‰

---

## ãƒ‡ãƒãƒƒã‚°ã®ã‚³ãƒ„

### 1. console.log ã‚’ä½¿ã†

```typescript
function calculateTotal(items: Item[]): number {
  console.log("items:", items);  // â† ç¢ºèª

  const total = items.reduce((sum, item) => {
    console.log("Processing item:", item);  // â† é€”ä¸­çµŒéã‚’ç¢ºèª
    return sum + item.price;
  }, 0);

  console.log("total:", total);  // â† çµæœã‚’ç¢ºèª
  return total;
}
```

### 2. å°ã•ãåˆ†ã‘ã¦ãƒ†ã‚¹ãƒˆã™ã‚‹

```typescript
// âœ… è‰¯ã„ä¾‹: å°ã•ãåˆ†ã‘ã‚‹
function processData(data: Data): Result {
  const validated = validateData(data);  // â† ã“ã“ã§ãƒ†ã‚¹ãƒˆ
  const transformed = transformData(validated);  // â† ã“ã“ã§ãƒ†ã‚¹ãƒˆ
  const result = saveData(transformed);  // â† ã“ã“ã§ãƒ†ã‚¹ãƒˆ
  return result;
}

// âŒ æ‚ªã„ä¾‹: ä¸€åº¦ã«å…¨éƒ¨ã‚„ã‚‹
function processData(data: Data): Result {
  // é•·ã„å‡¦ç†...
  // ã©ã“ã§ã‚¨ãƒ©ãƒ¼ãŒå‡ºãŸã‹åˆ†ã‹ã‚‰ãªã„
}
```

### 3. ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã—ã¦çµã‚Šè¾¼ã‚€

```typescript
function myFunction() {
  doSomething1();  // â† ã“ã“ã¾ã§å‹•ãï¼Ÿ
  // doSomething2();  // â† ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆ
  // doSomething3();
}
```

---

## å‚è€ƒè³‡æ–™

- [Firebase ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://firebase.google.com/docs)
- [TypeScript ãƒãƒ³ãƒ‰ãƒ–ãƒƒã‚¯](https://www.typescriptlang.org/docs/handbook/intro.html)
- [Stack Overflow](https://stackoverflow.com/)
- [GitHub Issues](https://github.com/firebase/firebase-tools/issues)

---

**å›°ã£ãŸã¨ãã¯**:
1. ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’èª­ã‚€
2. ãƒ­ã‚°ã‚’ç¢ºèªã™ã‚‹
3. æ¤œç´¢ã™ã‚‹
4. ãƒãƒ¼ãƒ ã«èã

ç„¦ã‚‰ãšã€ä¸€ã¤ãšã¤ç¢ºèªã—ã¦ã„ãã¾ã—ã‚‡ã†ï¼ ğŸ’ª
