# Phase 1完了後の動作確認ガイド

## 目的

Expo Phase 1（基盤構築）が完了しました！このガイドでは、実装された機能を実際に動かして確認する方法を説明します。

**対象読者**: 中学生・高校生レベルでもわかるように書いています。

---

## 1. 準備

### 1-1. 必要なもの

- ✅ パソコン（Windows/Mac/Linux）
- ✅ インターネット接続
- ✅ Webブラウザ（Chrome推奨）
- ✅ Node.js（インストール済み）
- ✅ Firebaseエミュレータ（起動中）

### 1-2. Firebaseエミュレータの起動

**重要**: Expoアプリを動かす前に、必ずFirebaseエミュレータを起動してください。

```bash
# プロジェクトルートで実行
firebase emulators:start
```

**確認方法**:
- ブラウザで `http://localhost:4000` を開く
- Emulator Suite UIが表示されればOK

---

## 2. Expoアプリの起動

### 2-1. 開発サーバーの起動

```bash
cd expo_app
npx expo start
```

**成功すると以下のような表示が出ます**:
```
› Metro waiting on exp://192.168.x.x:8081
› Scan the QR code above with Expo Go (Android) or the Camera app (iOS)

› Press a │ open Android
› Press i │ open iOS simulator
› Press w │ open web

› Press j │ open debugger
› Press r │ reload app
› Press m │ toggle menu
› Press o │ open project code in your editor
```

### 2-2. Webブラウザで開く

1. ターミナルで **`w`キー** を押す（または表示されたURLをクリック）
2. ブラウザが自動的に開く（通常 `http://localhost:8081`）
3. Metroバンドラーがコードをビルドする（初回は1-2分かかります）

**ロード中の表示**:
```
Bundling...
Building JavaScript bundle [████████████████████] 100%
```

---

## 3. 実装された機能の確認

Phase 1で実装された10個のチケットをすべて確認します。

### ✅ チケット001-004: Firebase接続・環境・状態管理・ルーティング

これらは裏側の仕組みなので、動作していれば自動的に確認済みです。

### ✅ チケット005: UI基盤（React Native Paper）

すべての画面でMaterial Design 3のコンポーネントが使われています。

**確認方法**:
- ボタンが丸みを帯びている（Material Design 3スタイル）
- カードに影がついている
- カラーが統一されている（グリーン `#4CAF50` がメインカラー）

### ✅ チケット006: 認証画面（ログイン・登録）

#### 3-1. 新規登録

1. 初回アクセスで**ログイン画面**が表示される
2. 下部の **「アカウントを作成」** をタップ
3. **新規登録画面**で以下を入力:
   - メールアドレス: `test@example.com`
   - パスワード: `Password123!`（8文字以上、大文字小文字数字記号を含む）
   - パスワード再入力: `Password123!`
4. **「登録」ボタン** をタップ

**成功すると**:
- 利用規約同意画面が表示される

#### 3-2. ログイン（2回目以降）

1. ログイン画面で以下を入力:
   - メールアドレス: `test@example.com`
   - パスワード: `Password123!`
2. **「ログイン」ボタン** をタップ

**成功すると**:
- ホーム画面が表示される

#### 3-3. パスワードリセット

1. ログイン画面で **「パスワードをお忘れですか？」** をタップ
2. メールアドレスを入力
3. **「リセットメールを送信」** をタップ

**エミュレータ環境の場合**:
- Firebaseエミュレータは実際のメールを送信しない
- 本番環境では実際にメールが送信される

### ✅ チケット007: 利用規約同意画面

#### 3-4. 利用規約同意

1. 新規登録後、**利用規約同意画面**が表示される
2. **「利用規約」リンク** と **「プライバシーポリシー」リンク** をタップして内容を確認
3. 2つのチェックボックスにチェックを入れる:
   - ✅ 利用規約に同意します
   - ✅ プライバシーポリシーに同意します
4. **「同意して続ける」ボタン** をタップ

**成功すると**:
- ホーム画面にリダイレクトされる

### ✅ チケット010: ボトムナビゲーション

#### 3-5. タブの切り替え

画面下部に **4つのタブ** が表示されています:

| タブ | アイコン | 説明 |
|------|---------|------|
| **ホーム** | 🏠 | メイン画面 |
| **トレーニング** | 🏋️ | トレーニング種目一覧 |
| **履歴** | 📊 | トレーニング履歴 |
| **設定** | ⚙️ | プロフィール・設定 |

**確認方法**:
- 各タブをタップして画面が切り替わることを確認
- アクティブなタブは**グリーン（#4CAF50）**で表示される
- 非アクティブなタブは**グレー（#999）**で表示される

### ✅ チケット008: ホーム画面

#### 3-6. ホーム画面の確認

ホーム画面には以下の要素が表示されます:

1. **ウェルカムメッセージ**
   - 「こんにちは、[ユーザー名]さん！」
   - ユーザーアバター（イニシャル）

2. **クイックスタートカード**
   - 「今日もトレーニングを始めましょう！」
   - **「トレーニングを始める」ボタン**

3. **統計カード**
   - 今日のセッション数
   - 週間進捗バー（7日分）
   - 今週の合計セッション数

4. **最近のアクティビティ**
   - Phase 2で実装予定（現在は空状態）
   - 「まだトレーニング履歴がありません」と表示

5. **サブスクリプション情報**
   - 現在のプラン（無料プラン）
   - プレミアムプランへのアップグレードリンク

**確認方法**:
- 画面を下にスワイプして **Pull-to-Refresh** が動作することを確認
- リフレッシュ中、ローディングインジケーターが表示される

### ✅ チケット009: プロフィール画面

#### 3-7. 設定画面（プロフィール）の確認

**「設定」タブ**をタップすると、以下のセクションが表示されます:

1. **プロフィール**
   - ユーザーアバター
   - ユーザー名（displayName）
   - メールアドレス
   - 登録日

2. **統計情報**
   - 総セッション数: 0回
   - 総トレーニング時間: 0分
   - 平均スコア: 0点

3. **同意状況**
   - 利用規約: 同意済み ✅
   - プライバシーポリシー: 同意済み ✅

4. **トレーニング設定**
   - 音声フィードバック: ON/OFF切り替え可能

5. **通知設定**
   - リマインダー通知: ON/OFF切り替え可能
   - お知らせ通知: ON/OFF切り替え可能

6. **データ管理**（Phase 2で実装）
   - データエクスポート
   - データ削除

7. **サポート**（Phase 2で実装）
   - ヘルプ
   - 利用規約
   - プライバシーポリシー
   - お問い合わせ

8. **アカウント操作**
   - **ログアウトボタン**
   - **アカウント削除ボタン**

#### 3-8. ログアウト機能の確認

1. 設定画面の最下部にある **「ログアウト」ボタン** をタップ
2. 確認ダイアログが表示される:
   > ログアウトしますか？
   >
   > ログアウトすると、再度ログインが必要になります。

3. **「ログアウト」** をタップ

**成功すると**:
- ログイン画面に戻る
- 認証状態がクリアされる

#### 3-9. アカウント削除機能の確認（テスト用アカウントのみ！）

**⚠️ 警告**: この操作は取り消せません。テスト用アカウントでのみ試してください。

1. 設定画面の最下部にある **「アカウントを削除」ボタン** をタップ
2. 警告ダイアログが表示される:
   > アカウントを削除しますか？
   >
   > この操作は取り消せません。すべてのデータが完全に削除されます。

3. **「削除」** をタップ

**成功すると**:
- アカウントがFirebase Authから削除される
- ログイン画面に戻る
- 削除されたアカウントで再度ログインはできない

---

## 4. トラブルシューティング

### 問題1: Expoアプリが起動しない

**エラー**: `npx expo start` で失敗する

**解決方法**:
```bash
# 依存関係を再インストール
cd expo_app
rm -rf node_modules
npm install

# キャッシュをクリア
npx expo start -c
```

### 問題2: Firebaseに接続できない

**エラー**: 「Firebase接続エラー」と表示される

**解決方法**:
1. Firebaseエミュレータが起動しているか確認
   ```bash
   firebase emulators:start
   ```
2. `.env.development` ファイルを確認
   - `EXPO_PUBLIC_USE_EMULATOR=true` になっているか確認

### 問題3: ログイン後に画面が真っ白

**解決方法**:
1. ブラウザのDevToolsを開く（F12キー）
2. コンソールにエラーが表示されていないか確認
3. ページをリロード（Ctrl+R または Cmd+R）

### 問題4: ボトムナビゲーションが表示されない

**解決方法**:
1. ログインしているか確認（未ログインではナビゲーションは表示されない）
2. 利用規約に同意しているか確認
3. ブラウザのキャッシュをクリアしてリロード

---

## 5. 次のステップ（Phase 2）

Phase 1が完了したら、次はPhase 2に進みます！

### Phase 2で実装される機能

| チケット | 機能 | 説明 |
|---------|------|------|
| 011-013 | MediaPipe統合 | カメラとMediaPipe姿勢検出 |
| 014-019 | 5種目実装 | スクワット、プッシュアップ、アームカール、サイドレイズ、ショルダープレス |
| 020-025 | トレーニング記録 | Firestoreへのデータ保存、履歴表示 |
| 026-030 | BigQuery連携 | 分析データパイプライン |

**Phase 2開始前の準備**:
- MediaPipeネイティブモジュールのインストール
- Expo Development Buildの作成（MediaPipeはExpo Goでは動作しない）
- カメラパーミッションの設定

---

## 6. チェックリスト

Phase 1の全機能が正しく動作しているか、このチェックリストで確認してください。

### 基本動作

- [ ] Expoアプリが起動する（`npx expo start`）
- [ ] Webブラウザでアプリが表示される
- [ ] Firebaseエミュレータに接続できる

### 認証機能

- [ ] 新規登録ができる
- [ ] ログインができる
- [ ] パスワードリセットメールが送信される
- [ ] ログアウトができる
- [ ] アカウント削除ができる

### 同意機能

- [ ] 利用規約同意画面が表示される
- [ ] 利用規約とプライバシーポリシーのリンクが動作する
- [ ] 両方にチェックを入れないと「同意して続ける」ボタンが押せない
- [ ] 同意後、ホーム画面にリダイレクトされる

### ナビゲーション

- [ ] ボトムナビゲーションが表示される
- [ ] 4つのタブすべてが表示される
- [ ] タブをタップすると画面が切り替わる
- [ ] アクティブタブがグリーンで表示される

### ホーム画面

- [ ] ウェルカムメッセージが表示される
- [ ] ユーザーアバターが表示される
- [ ] クイックスタートカードが表示される
- [ ] 統計カードが表示される
- [ ] Pull-to-Refreshが動作する

### 設定画面

- [ ] プロフィール情報が表示される
- [ ] 統計情報が表示される
- [ ] 同意状況が表示される
- [ ] トレーニング設定が切り替えられる
- [ ] 通知設定が切り替えられる
- [ ] ログアウトボタンが動作する
- [ ] アカウント削除ボタンが動作する（確認ダイアログ付き）

---

## 7. よくある質問（FAQ）

### Q1: エミュレータと本番環境の違いは？

**A**: エミュレータは開発用のローカル環境です。

| 項目 | エミュレータ | 本番環境 |
|------|------------|---------|
| Firebase Auth | ローカルデータベース | Google Cloud |
| Firestore | ローカルデータベース | Google Cloud |
| メール送信 | 送信されない（ログのみ） | 実際に送信される |
| データ永続化 | PCを再起動すると消える | 永続的に保存される |
| コスト | 無料 | 使用量に応じて課金 |

### Q2: スマートフォンでも確認できる？

**A**: はい、Expo Goアプリを使えば可能です。

1. スマートフォンに「Expo Go」アプリをインストール
   - iOS: App Store
   - Android: Google Play Store
2. `npx expo start` で表示されるQRコードをスキャン
3. アプリが自動的に開く

**注意**: Phase 2のMediaPipe機能はExpo Goでは動作しません（Development Buildが必要）。

### Q3: コードを編集したらすぐに反映される？

**A**: はい、ホットリロード機能があります。

- `.tsx` ファイルを編集して保存すると、自動的にアプリがリロードされます
- 変更が反映されない場合は、ターミナルで `r` キーを押して手動リロード

### Q4: エラーログはどこで見る？

**A**: ブラウザのDevToolsで確認できます。

1. ブラウザでF12キー（またはCmd+Option+I）を押す
2. **Console** タブを開く
3. エラーメッセージを確認

**Firebaseエミュレータのログ**:
- `http://localhost:4000` のEmulator Suite UIで確認
- **Logs** タブを開く

---

## 8. まとめ

おめでとうございます！Expo Phase 1の全機能が動作していることを確認できました。

**完了したチケット**: 10/10（100%）

| チケット | タイトル | ステータス |
|---------|---------|-----------|
| 001 | Firebase接続設定 | ✅ 完了 |
| 002 | Expo開発環境セットアップ | ✅ 完了 |
| 003 | Zustand状態管理基盤 | ✅ 完了 |
| 004 | Expo Router設定 | ✅ 完了 |
| 005 | React Native Paper UI基盤 | ✅ 完了 |
| 006 | 認証画面（ログイン・登録） | ✅ 完了 |
| 007 | 利用規約同意画面 | ✅ 完了 |
| 008 | ホーム画面 | ✅ 完了 |
| 009 | プロフィール画面 | ✅ 完了 |
| 010 | ボトムナビゲーション | ✅ 完了 |

**次のステップ**:
- Phase 2の計画を確認する
- MediaPipe統合の準備を始める
- Development Buildの作成方法を学ぶ

---

## 9. お問い合わせ

問題が解決しない場合は、以下の情報を添えて質問してください:

1. **エラーメッセージ**（コンソールのログ全文）
2. **実行したコマンド**
3. **環境情報**（Windows/Mac/Linux、Node.jsバージョン）
4. **再現手順**（どの操作でエラーが発生したか）

---

**最終更新**: 2025-12-10
**バージョン**: Phase 1 完了版
